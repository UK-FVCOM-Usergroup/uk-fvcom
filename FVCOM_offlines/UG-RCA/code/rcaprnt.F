      SUBROUTINE RCAPRNT(ARRAY,IBEG,IEND,MN)
!
!          RCAPRNT IS A GENERAL PRINT ROUTINE FOR ARRAYS
!
      USE MOD_RCA
      USE ALL_VARS,ONLY : M,MT,N,NT,SERIAL,MSR,PAR,MYID,NPROCS
# if defined (MULTIPROCESSOR)
      USE MOD_PAR
# endif            
      IMPLICIT NONE
      SAVE
!      INCLUDE  'RCACM'
      REAL :: ARRAY(0:MN,NZ)
      REAL,ALLOCATABLE :: ARRAY_TMP(:,:)
      INTEGER :: NLAYS,IBEG,IEND,IZAY,MN

      NLAYS = IEND-IBEG+1
!JQI      IF(MSR) WRITE(OUT,1000)
!JQI  1000 FORMAT(1X,'LAYER  COLUMN',46X,'ROWS')

      IF(SERIAL .AND. MSR)THEN
       DO IXY=1,NXY
        WRITE(OUT,1100)  'NODE  LAYER= ',(IZAY,IZAY=IBEG,IEND)
        WRITE(OUT,1200) IXY,(ARRAY(IXY,IZAY),IZAY=IBEG,IEND)
       END DO
      END IF 

# if defined (MULTIPROCESSOR)
      IF(PAR)THEN
       IF(MN == MT)THEN
        ALLOCATE(ARRAY_TMP(NXY,NZ))
        CALL GATHER(LBOUND(ARRAY,1),UBOUND(ARRAY,1),M,NXY,NZ,MYID,NPROCS,  &
                   NMAP,ARRAY,ARRAY_TMP)
        IF(MSR)THEN
         DO IXY=1,NXY
	  WRITE(OUT,1100)  'NODE  LAYER= ',(IZAY,IZAY=IBEG,IEND)
          WRITE(OUT,1200) IXY,(ARRAY_TMP(IXY,IZAY),IZAY=IBEG,IEND)
         END DO
        END IF	
	DEALLOCATE(ARRAY_TMP)
       ELSE IF(MN == NT)THEN
        ALLOCATE(ARRAY_TMP(EXY,NZ))
        CALL GATHER(LBOUND(ARRAY,1),UBOUND(ARRAY,1),N,EXY,NZ,MYID,NPROCS,  &
                   EMAP,ARRAY,ARRAY_TMP)
        IF(MSR)THEN
         DO IXY=1,EXY
	  WRITE(OUT,1100)  'NODE  LAYER= ',(IZAY,IZAY=IBEG,IEND)
          WRITE(OUT,1200) IXY,(ARRAY_TMP(IXY,IZAY),IZAY=IBEG,IEND)
         END DO
        END IF	
	DEALLOCATE(ARRAY_TMP)
       ELSE IF(MN == NXY)THEN
        IF(MSR)THEN
         DO IXY=1,NXY
          WRITE(OUT,1100)  'NODE  LAYER= ',(IZAY,IZAY=IBEG,IEND)
          WRITE(OUT,1200) IXY,(ARRAY(IXY,IZAY),IZAY=IBEG,IEND)
         END DO
        END IF 
       END IF		
      END IF 
# endif            

 1100  FORMAT(//1X,A13,<NLAYS>I10)
 1200  FORMAT(14X,I5,<NLAYS>E10.3)

      RETURN
      END SUBROUTINE  RCAPRNT
